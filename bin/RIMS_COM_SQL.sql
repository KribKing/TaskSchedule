


/*
1.服务下载程序配置表
2.创建人：jjb 创建时间：20201020
*/

IF NOT EXISTS(SELECT 1 FROM sysobjects WHERE name='CronJob')
BEGIN
	CREATE TABLE CronJob
	(
	 id VARCHAR(32) PRIMARY KEY NOT NULL ,--作业编码
	 name VARCHAR(1024) NOT NULL , --作业名称
	 system VARCHAR(32) NOT NULL, --作业大类
	 sysname VARCHAR(1024) NOT NULL ,--作业大类名称
	 memo VARCHAR(1024), --备注
	 oper_date DATETIME,--
	 sql VARCHAR(max),--sql脚本
	 weburl VARCHAR(1024),--服务地址
	 createtmp VARCHAR(max),--临时表创建脚本
	 tmpname VARCHAR(256),--临时表名
	 node VARCHAR(1024),--解析节点
	 nodelx SMALLINT,
	 zylx SMALLINT,
	 xmlschema VARCHAR(max),
	 expression VARCHAR(max) NOT NULL ,--作业时间表达式
	 jlzt SMALLINT NOT NULL  --作业状态 0：启用 1：禁用
	)
	--ALTER TABLE dbo.CronJob ADD xmlschema VARCHAR(max)
END 
GO
/*
1.服务下载程序作业执行记录表
3.创建人：jjb 创建时间：20201020
*/
IF NOT EXISTS(SELECT 1 FROM sysobjects WHERE name='CronJob_JOBHISTORY')
BEGIN
   CREATE TABLE CronJob_JOBHISTORY
   (
        xh DECIMAL(18,0) IDENTITY(1,1) PRIMARY KEY NOT NULL ,--自增序号
		id VARCHAR(32) NOT NULL ,--作业编码
		system VARCHAR(32), --作业大类
		oper_date DATETIME,--操作时间
		zxzt SMALLINT,--执行状态 0：成功 1：失败
		rawtext VARCHAR(max)--原始文本
   )
END 
GO


IF EXISTS(SELECT 1 FROM sysobjects WHERE name='usp_jk_getjobhistory')
   DROP PROC usp_jk_getjobhistory
GO
CREATE PROC usp_jk_getjobhistory
   @id varchar(32)=NULL,
   @sys varchar(32)=NULL,
   @kssj DATETIME=null,
   @jssj DATETIME=null
AS

SELECT a.xh,a.id,b.name,b.sysname system,a.oper_date sj,a.zxzt--,a.rawtext 
FROM  CronJob_JOBHISTORY a(nolock) 
INNER JOIN CronJob b(nolock) ON a.id=b.id --AND a.system=b.system
WHERE a.id=@id --AND a.system=@sys AND oper_date BETWEEN @kssj AND @jssj

RETURN
GO

--SELECT COUNT(*) FROM RIMS_JOBHISTORY



IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData00')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData00','卫宁数据-获取医院信息','卫宁数据','WnData','',GETDATE(),'dXBkYXRlIGEgc2V0IGEubmFtZT1iLm5hbWUsYS55eWRtPWIueWxqZ2RtDQpmcm9tIFJJTVNfWVlETUsgYShub2xvY2spDQppbm5lciBqb2luIFdOREFUQV9ZWURNSyBiKG5vbG9jaykgb24gYS5pZD1iLnl5ZG0NCg0KaW5zZXJ0IGludG8gUklNU19ZWURNSyhpZCxuYW1lLHl5ZG0seXlkaixsYikNCnNlbGVjdCB5eWRtLG5hbWUseWxqZ2RtLDAsMCBmcm9tIFdOREFUQV9ZWURNSyBhKG5vbG9jaykNCndoZXJlIG5vdCBleGlzdHMoc2VsZWN0IDEgZnJvbSBSSU1TX1lZRE1LIGIobm9sb2NrKSB3aGVyZSBhLnl5ZG09Yi5pZCkNCg0KZHJvcCB0YWJsZSBXTkRBVEFfWVlETUs=','http://172.16.1.56:8889/api/app/his/rmis_yydmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1lZRE1LJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWVlETUsNCiAgICAgKA0KICAgICAgICAgeXlkbSB2YXJjaGFyKDMyKSBub3QgbnVsbCwNCiAgICAgICAgIG5hbWUgdmFyY2hhcigxMDI0KSBub3QgbnVsbCwNCiAgICAgICAgIHlsamdkbSB2YXJjaGFyKDMyKSBudWxsDQogICAgICkNCmVuZCANCmVsc2UgDQpiZWdpbg0KICAgIHRydW5jYXRlIHRhYmxlIFdOREFUQV9ZWURNSw0KZW5k','WNDATA_YYDMK','0 0/3 * * * ? *',1
END 
GO

IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData01')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData01','卫宁数据-获取科室信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLm5hbWUsYS5weT1MT1dFUihiLnB5KSxhLndiPUxPV0VSKGIud2IpLGEueXlkbT1iLnl5ZG0sYS55amtzX2lkPWIueWprc19pZCxhLnlqa3NfbWM9Yi55amtzX21jLGEuZWprc19pZD1iLmVqa3NfaWQsYS5lamtzX21jPWIuZWprc19tYywNCmEueWJrc19pZD1iLnlia3NfaWQsYS55YmtzX21jPWIueWJrc19tYyxhLmpsenQ9Y29udmVydChzbWFsbGludCxiLmpsenQpLGEubWVtbz1iLm1lbW8NCkZST00gZGJvLlJJTVNfS1NESUNUIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfS1NCTUsgYihub2xvY2spIG9uIGEuaWQ9Yi5pZA0KDQppbnNlcnQgaW50byBSSU1TX0tTRElDVChpZCxuYW1lLHB5LHdiLHl5ZG0seWprc19pZCx5amtzX21jLGVqa3NfaWQsZWprc19tYyx5YmtzX2lkLHlia3NfbWMsa3NsYixrc2J6LGpsenQsbWVtbykNCnNlbGVjdCBpZCxuYW1lLExPV0VSKHB5KSxMT1dFUih3YikseXlkbSx5amtzX2lkLHlqa3NfbWMsZWprc19pZCxlamtzX21jLHlia3NfaWQseWJrc19tYyxrc2xiLGtzYnosY29udmVydChzbWFsbGludCxqbHp0KSxtZW1vIA0KRlJPTSBXTkRBVEFfS1NCTUsgYShub2xvY2spDQp3aGVyZSBub3QgZXhpc3RzKHNlbGVjdCAxIGZyb20gUklNU19LU0RJQ1QgYihub2xvY2spIHdoZXJlIGEuaWQ9Yi5pZCkNCg0KDQpVUERBVEUgYSBzZXQgYS5OQU1FPWIubmFtZSxhLlBZPUxPV0VSKGIucHkpLGEuV0I9TE9XRVIoYi53YiksYS5ZWURNPWIueXlkbSxhLllKS1NfSUQ9Yi55amtzX2lkLGEuWUpLU19NQz1iLnlqa3NfbWMsYS5FSktTX0lEPWIuZWprc19pZCxhLkVKS1NfTUM9Yi5lamtzX21jLA0KYS5ZQktTX0lEPWIueWJrc19pZCxhLllCS1NfTUM9Yi55YmtzX21jLGEuSkxaVD1jb252ZXJ0KHNtYWxsaW50LGIuamx6dCksYS5NRU1PPWIubWVtbw0KRlJPTSBTWVNfS1NETUsgYShub2xvY2spDQppbm5lciBqb2luIFdOREFUQV9LU0JNSyBiKG5vbG9jaykgb24gYS5JRD1iLmlkDQoNCmluc2VydCBpbnRvIFNZU19LU0RNSyhJRCxOQU1FLFBZLFdCLFlZRE0sWUpLU19JRCxZSktTX01DLEVKS1NfSUQsRUpLU19NQyxZQktTX0lELFlCS1NfTUMsS1NMQixLU0JaLEpMWlQsTUVNTykNCnNlbGVjdCBpZCxuYW1lLExPV0VSKHB5KSxMT1dFUih3YikseXlkbSx5amtzX2lkLHlqa3NfbWMsZWprc19pZCxlamtzX21jLHlia3NfaWQseWJrc19tYyxrc2xiLGtzYnosY29udmVydChzbWFsbGludCxqbHp0KSxtZW1vIA0KRlJPTSBXTkRBVEFfS1NCTUsgYShub2xvY2spDQp3aGVyZSBub3QgZXhpc3RzKHNlbGVjdCAxIGZyb20gU1lTX0tTRE1LIGIobm9sb2NrKSB3aGVyZSBhLmlkPWIuSUQpDQoNCmRyb3AgdGFibGUgV05EQVRBX0tTQk1L','http://172.16.1.56:8889/api/app/his/rims_ksbmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0tTQk1LJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfS1NCTUsNCiAgICAgKA0KICAgICAgICAgaWQgdmFyY2hhcigzMikgbm90IG51bGwsDQogICAgICAgICBuYW1lIHZhcmNoYXIoMTAyNCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHl5ZG0gdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHlqa3NfaWQgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHlqa3NfbWMgdmFyY2hhcigxMjgpIG51bGwsDQogICAgICAgICBlamtzX2lkIHZhcmNoYXIoMzIpIG51bGwsDQogICAgICAgICBlamtzX21jIHZhcmNoYXIoMTI4KSBudWxsLA0KICAgICAgICAgeWJrc19pZCB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgeWJrc19tYyB2YXJjaGFyKDEyOCkgbnVsbCwNCiAgICAgICAgIGtzbGIgdmFyY2hhcig1KSBudWxsLA0KICAgICAgICAga3NieiB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBqbHp0IHZhcmNoYXIoNSludWxsLA0KICAgICAgICAgbWVtbyB2YXJjaGFyKDI0KSBudWxsDQogICAgICkNCmVuZCANCmVsc2UgDQpiZWdpbg0KICAgIHRydW5jYXRlIHRhYmxlIFdOREFUQV9LU0JNSw0KZW5k','WNDATA_KSBMK','0 0/3 * * * ? *',1
END 
GO

IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData02')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData02','卫宁数据-获取人员信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLm5hbWUsYS5weT1MT1dFUihiLnB5KSxhLndiPUxPV0VSKGIud2IpLGEuc2V4PUNBU0UgV0hFTiBiLnNleD0n55S3JyBUSEVOIDAgV0hFTiBiLnNleD0n5aWzJyBUSEVOIDEgRUxTRSAyIEVORCAsDQphLmJpcnRoPWIuYmlydGgsYS5oeXprPWIuaHl6ayxhLnNmemg9Yi5zZnpoLGEua3NfaWQ9Yi5rc19pZCwNCmEua3NfbWM9Yi5rc19tYyxhLmJxX2lkPWIuYnFfaWQsYS5icV9tYz1iLmJxX21jLGEuemdsYj1iLnpnbGIsYS5qbHp0PWIuamx6dCxhLm1lbW89Yi5tZW1vDQpGUk9NIGRiby5SSU1TX1pHQk1LIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfWkdCTUsgYihub2xvY2spIG9uIGEuaWQ9Yi5pZA0KDQppbnNlcnQgaW50byBSSU1TX1pHQk1LKGlkLG5hbWUscHksd2Isc2V4LGJpcnRoLGh5emssc2Z6aCxrc19pZCxrc19tYyxicV9pZCxicV9tYyx6Z2xiLGpsenQsbWVtbykNCnNlbGVjdCBpZCxuYW1lLExPV0VSKHB5KSxMT1dFUih3YiksQ0FTRSBXSEVOIGEuc2V4PSfnlLcnIFRIRU4gMCBXSEVOIGEuc2V4PSflpbMnIFRIRU4gMSBFTFNFIDIgRU5ELGJpcnRoLGh5emssc2Z6aCxrc19pZCxrc19tYyxicV9pZCxicV9tYyx6Z2xiLGpsenQsbWVtbyANCkZST00gV05EQVRBX1pHQk1LIGEobm9sb2NrKQ0Kd2hlcmUgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIFJJTVNfWkdCTUsgYihub2xvY2spIHdoZXJlIGEuaWQ9Yi5pZCkNCg0KVVBEQVRFIGEgIHNldCBhLk5BTUU9Yi5uYW1lLGEuUFk9TE9XRVIoYi5weSksYS5XQj1MT1dFUihiLndiKSxhLlNFWD1DQVNFIFdIRU4gYi5zZXg9J+eUtycgVEhFTiAwIFdIRU4gYi5zZXg9J+WlsycgVEhFTiAxIEVMU0UgMiBFTkQsDQphLkJJUlRIPWIuYmlydGgsYS5TRlpIPWIuc2Z6aCxhLktTRE09Yi5rc19pZCxhLktTX01DPWIua3NfbWMsYS5CUURNPWIuYnFfaWQsYS5CUV9NQz1iLmJxX21jLGEuWkdMQj1iLnpnbGIsYS5KTFpUPWIuamx6dCxhLk1FTU89Yi5tZW1vDQpGUk9NIFNZU19aR0RNSyBhKG5vbG9jaykNCmlubmVyIGpvaW4gV05EQVRBX1pHQk1LIGIobm9sb2NrKSBvbiBhLklEPWIuaWQNCg0KSU5TRVJUIElOVE8gU1lTX1pHRE1LKElELE5BTUUsUFksV0IsU0VYLEJJUlRILFNGWkgsS1NETSxLU19NQyxCUURNLEJRX01DLFpHTEIsSkxaVCxNRU1PLElTREwsUEFTU1dPUkQsUkVHSVNUX1RJTUUsSVNTRCxMU1lIQlopDQpTRUxFQ1QgaWQsbmFtZSxMT1dFUihweSksTE9XRVIod2IpLENBU0UgV0hFTiBhLnNleD0n55S3JyBUSEVOIDAgV0hFTiBhLnNleD0n5aWzJyBUSEVOIDEgRUxTRSAyIEVORCxiaXJ0aCxzZnpoLGtzX2lkLGtzX21jLGJxX2lkLGJxX21jLHpnbGIsamx6dCxtZW1vLDEsJ2dWbVhwd0JsR01jPScsJzIwMTQwNzAxMDA6MDA6MDAnLDEsMQ0KRlJPTSBXTkRBVEFfWkdCTUsgYShOT0xPQ0spDQpXSEVSRSBOT1QgRVhJU1RTKFNFTEVDVCAxIEZST00gU1lTX1pHRE1LIGIoTk9MT0NLKSBXSEVSRSBhLmlkPWIuSUQpDQoNCmRyb3AgdGFibGUgV05EQVRBX1pHQk1L','http://172.16.1.56:8889/api/app/his/rims_zgbmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1pHQk1LJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWkdCTUsNCiAgICAgKA0KICAgICAgICAgaWQgdmFyY2hhcig4KSBub3QgbnVsbCwNCiAgICAgICAgIG5hbWUgdmFyY2hhcig2NCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHNleCB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBiaXJ0aCBWQVJDSEFSKDgpIG51bGwsDQogICAgICAgICBoeXprIHZhcmNoYXIoNSkgbnVsbCwNCiAgICAgICAgIHNmemggdmFyY2hhcigyMCkgbnVsbCwNCiAgICAgICAgIGtzX2lkIHZhcmNoYXIoOCkgbnVsbCwNCiAgICAgICAgIGtzX21jIHZhcmNoYXIoNjQpIG51bGwsDQogICAgICAgICBicV9pZCB2YXJjaGFyKDgpIG51bGwsDQogICAgICAgICBicV9tYyB2YXJjaGFyKDY0KSBudWxsLA0KICAgICAgICAgemdsYiB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBqbHp0IHZhcmNoYXIoNSkgTlVMTCwNCiAgICAgICAgIG1lbW8gdmFyY2hhcigyNCkgbnVsbA0KICAgICApDQplbmQgDQplbHNlIA0KYmVnaW4NCiAgICBkcm9wIHRhYmxlIFdOREFUQV9aR0JNSw0KICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWkdCTUsNCiAgICAgKA0KICAgICAgICAgaWQgdmFyY2hhcig4KSBub3QgbnVsbCwNCiAgICAgICAgIG5hbWUgdmFyY2hhcig2NCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHNleCB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBiaXJ0aCBWQVJDSEFSKDgpIG51bGwsDQogICAgICAgICBoeXprIHZhcmNoYXIoNSkgbnVsbCwNCiAgICAgICAgIHNmemggdmFyY2hhcigyMCkgbnVsbCwNCiAgICAgICAgIGtzX2lkIHZhcmNoYXIoOCkgbnVsbCwNCiAgICAgICAgIGtzX21jIHZhcmNoYXIoNjQpIG51bGwsDQogICAgICAgICBicV9pZCB2YXJjaGFyKDgpIG51bGwsDQogICAgICAgICBicV9tYyB2YXJjaGFyKDY0KSBudWxsLA0KICAgICAgICAgemdsYiB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBqbHp0IHZhcmNoYXIoNSkgTlVMTCwNCiAgICAgICAgIG1lbW8gdmFyY2hhcigyNCkgbnVsbA0KICAgICApDQplbmQ=','WNDATA_ZGBMK','0 0/3 * * * ? *',1
END 
GO
--SELECT * FROM RIMS_COM_SQL
--DELETE RIMS_COM_SQL WHERE system='WnData' AND id='WnData03'
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData03')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData03','卫宁数据-获取病区信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLmRlcHRfbmFtZSxhLnB5PUxPV0VSKGIucHkpLGEud2I9TE9XRVIoYi53YiksYS55eWRtPWIueXlkbSxhLmxiPWIubGIsYS5qbHp0PWNhc2Ugd2hlbiBpc251bGwoYi5qbHp0LCcxJyk9JzAnIHRoZW4gMCBlbHNlIDEgZW5kICxhLm1lbW89Yi5tZW1vDQpGUk9NIGRiby5SSU1TX0JRQk1LIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfQlFCTUsgYihub2xvY2spIG9uIGEuaWQ9Yi53YXJkX2NvZGUNCg0KaW5zZXJ0IGludG8gUklNU19CUUJNSyhpZCxuYW1lLHB5LHdiLHl5ZG0sbGIsamx6dCxtZW1vKQ0Kc2VsZWN0IHdhcmRfY29kZSxkZXB0X25hbWUsTE9XRVIocHkpLExPV0VSKHdiKSx5eWRtLGxiLGNhc2Ugd2hlbiBpc251bGwoYS5qbHp0LCcxJyk9JzAnIHRoZW4gMCBlbHNlIDEgZW5kLG1lbW8gZnJvbSBXTkRBVEFfQlFCTUsgYShub2xvY2spDQp3aGVyZSBub3QgZXhpc3RzKHNlbGVjdCAxIGZyb20gUklNU19CUUJNSyBiKG5vbG9jaykgd2hlcmUgYS53YXJkX2NvZGU9Yi5pZCkNCg0KDQpVUERBVEUgYSBzZXQgYS5OQU1FPWIuZGVwdF9uYW1lLGEuUFk9TE9XRVIoYi5weSksYS5XQj1MT1dFUihiLndiKSxhLllZRE09Yi55eWRtLGEuSkxaVD1jYXNlIHdoZW4gaXNudWxsKGIuamx6dCwnMScpPScwJyB0aGVuIDAgZWxzZSAxIGVuZCxhLk1FTU89Yi5tZW1vDQpGUk9NIFNZU19CUURNSyBhKG5vbG9jaykNCmlubmVyIGpvaW4gV05EQVRBX0JRQk1LIGIobm9sb2NrKSBvbiBhLklEPWIud2FyZF9jb2RlDQoNCklOU0VSVCBJTlRPIFNZU19CUURNSyhJRCxOQU1FLFBZLFdCLFlZRE0sTEIsSkxaVCxNRU1PKQ0KU0VMRUNUIHdhcmRfY29kZSxkZXB0X25hbWUsTE9XRVIocHkpLExPV0VSKHdiKSx5eWRtLGxiLGNhc2Ugd2hlbiBpc251bGwoYS5qbHp0LCcxJyk9JzAnIHRoZW4gMCBlbHNlIDEgZW5kLG1lbW8NCkZST00gV05EQVRBX0JRQk1LIGEoTk9MT0NLKQ0KV0hFUkUgTk9UIEVYSVNUUyhTRUxFQ1QgMSBGUk9NIFNZU19CUURNSyBiKE5PTE9DSykgV0hFUkUgYS53YXJkX2NvZGU9Yi5JRCkNCg0KZHJvcCB0YWJsZSBXTkRBVEFfQlFCTUs=','http://172.16.1.56:8889/api/app/his/rims_bqbmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0JRQk1LJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfQlFCTUsNCiAgICAgKA0KICAgICAgICAgd2FyZF9jb2RlIHZhcmNoYXIoOCkgbm90IG51bGwsDQogICAgICAgICBkZXB0X25hbWUgdmFyY2hhcig2NCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHl5ZG0gVkFSQ0hBUigyKSBOVUxMLA0KICAgICAgICAgbGIgdmFyY2hhcig1KSBudWxsLA0KICAgICAgICAgamx6dCB2YXJjaGFyKDUpIE5VTEwsDQogICAgICAgICBtZW1vIHZhcmNoYXIoMjQpIG51bGwNCiAgICAgKQ0KZW5kIA0KZWxzZSANCmJlZ2luDQogICAgDQogICAgZHJvcCB0YWJsZSBXTkRBVEFfQlFCTUsNCiAgICAgY3JlYXRlIHRhYmxlIFdOREFUQV9CUUJNSw0KICAgICAoDQogICAgICAgICB3YXJkX2NvZGUgdmFyY2hhcig4KSBub3QgbnVsbCwNCiAgICAgICAgIGRlcHRfbmFtZSB2YXJjaGFyKDY0KSBub3QgbnVsbCwNCiAgICAgICAgIHB5IHZhcmNoYXIoMzIpIG51bGwsDQogICAgICAgICB3YiB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgeXlkbSBWQVJDSEFSKDIpIE5VTEwsDQogICAgICAgICBsYiB2YXJjaGFyKDUpIG51bGwsDQogICAgICAgICBqbHp0IHZhcmNoYXIoNSkgTlVMTCwNCiAgICAgICAgIG1lbW8gdmFyY2hhcigyNCkgbnVsbA0KICAgICApDQplbmQ=','WNDATA_BQBMK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData04')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData04','卫宁数据-获取收费项目信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLm5hbWUsYS5weT1MT1dFUihiLnB5KSxhLndiPUxPV0VSKGIud2IpLGEueG1kdz1iLnhtZHcsYS54bWdnPWIueG1nZyxhLnhtbGI9Q2FzdChDT05WRVJUKERFQ0lNQUwoMTIsMCksYi54bWxiKSBBUyBTTUFMTElOVCksYS5zeWJ6PWIuamx6dCxhLm1lbW89Yi5tZW1vDQpGUk9NIFJJTVNfU0ZYWE1LIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfU0ZYWE1LIGIobm9sb2NrKSBvbiBhLmlkPWIuaWQNCg0KaW5zZXJ0IGludG8gUklNU19TRlhYTUsoaWQsbmFtZSxweSx3Yix4bWR3LHhtZ2cseG1sYixzeWJ6LG1lbW8pDQpzZWxlY3QgaWQsbmFtZSxMT1dFUihweSksTE9XRVIod2IpLHhtZHcseG1nZyxDYXN0KENPTlZFUlQoREVDSU1BTCgxMiwwKSx4bWxiKSBBUyBTTUFMTElOVCksamx6dCxtZW1vIGZyb20gV05EQVRBX1NGWFhNSyBhKG5vbG9jaykNCndoZXJlIG5vdCBleGlzdHMoc2VsZWN0IDEgZnJvbSBSSU1TX1NGWFhNSyBiKG5vbG9jaykgd2hlcmUgYS5pZD1iLmlkKQ0KDQpkcm9wIHRhYmxlIFdOREFUQV9TRlhYTUs=','http://172.16.1.56:8889/api/app/his/rims_sfxxmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1NGWFhNSycpDQpiZWdpbg0KICAgICBjcmVhdGUgdGFibGUgV05EQVRBX1NGWFhNSw0KICAgICAoDQogICAgICAgICBpZCB2YXJjaGFyKDMyKSBub3QgbnVsbCwNCiAgICAgICAgIG5hbWUgdmFyY2hhcigxMjgpIG5vdCBudWxsLA0KICAgICAgICAgcHkgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHdiIHZhcmNoYXIoMzIpIG51bGwsDQogICAgICAgICB4bWR3IFZBUkNIQVIoNjQpIE5VTEwsDQogICAgICAgICB4bWdnIFZBUkNIQVIoNjQpIE5VTEwsDQogICAgICAgICB4bWRqIG1vbmV5IG51bGwsDQogICAgICAgICB4bWxiIFZBUkNIQVIoNSkgTlVMTCwNCiAgICAgICAgIGpsenQgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgbWVtbyB2YXJjaGFyKDI0KSBudWxsDQogICAgICkNCmVuZCANCmVsc2UgDQpiZWdpbg0KICAgIGRyb3AgdGFibGUgV05EQVRBX1NGWFhNSw0KICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfU0ZYWE1LDQogICAgICgNCiAgICAgICAgIGlkIHZhcmNoYXIoMzIpIG5vdCBudWxsLA0KICAgICAgICAgbmFtZSB2YXJjaGFyKDEyOCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDMyKSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcigzMikgbnVsbCwNCiAgICAgICAgIHhtZHcgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZ2cgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZGogbW9uZXkgbnVsbCwNCiAgICAgICAgIHhtbGIgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgamx6dCBWQVJDSEFSKDUpIE5VTEwsDQogICAgICAgICBtZW1vIHZhcmNoYXIoMjQpIG51bGwNCiAgICAgKQ0KZW5k','WNDATA_SFXXMK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData05')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData05','卫宁数据-获取临床项目信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLm5hbWUsYS5weT1MT1dFUihiLnB5KSxhLndiPUxPV0VSKGIud2IpLGEueG1kdz1iLnhtZHcsYS54bWRqPWIueG1kaixhLnhtbGI9Q0FTVChDT05WRVJUKERFQ0lNQUwoMTIsMCksYi54bWxiKSBBUyBzbWFsbGludCksYS5qbHp0PWIuamx6dCxhLm1lbW89Yi5tZW1vDQpGUk9NIFJJTVNfTENTRlhNSyBhKG5vbG9jaykNCmlubmVyIGpvaW4gV05EQVRBX0xDU0ZYTUsgYihub2xvY2spIG9uIGEuaWQ9Yi5pZA0KDQppbnNlcnQgaW50byBSSU1TX0xDU0ZYTUsoaWQsbmFtZSxweSx3Yix4bWR3LHhtZGoseG1sYixqbHp0LG1lbW8NCikNCnNlbGVjdCBpZCxuYW1lLExPV0VSKHB5KSxMT1dFUih3YikseG1kdyx4bWRqLENBU1QoQ09OVkVSVChERUNJTUFMKDEyLDApLGEueG1sYikgQVMgc21hbGxpbnQpLGpsenQsbWVtbyANCkZST00gV05EQVRBX0xDU0ZYTUsgYShub2xvY2spDQp3aGVyZSBub3QgZXhpc3RzKHNlbGVjdCAxIGZyb20gUklNU19MQ1NGWE1LIGIobm9sb2NrKSB3aGVyZSBhLmlkPWIuaWQpDQoNCg0KZHJvcCB0YWJsZSBXTkRBVEFfTENTRlhNSw==','http://172.16.1.56:8889/api/app/his/rims_lcsfxmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0xDU0ZYTUsnKQ0KYmVnaW4NCiAgICAgY3JlYXRlIHRhYmxlIFdOREFUQV9MQ1NGWE1LDQogICAgICgNCiAgICAgICAgIGlkIHZhcmNoYXIoMzIpIG5vdCBudWxsLA0KICAgICAgICAgbmFtZSB2YXJjaGFyKDEyOCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDY0KSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcig2NCkgbnVsbCwNCiAgICAgICAgIHhtZHcgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZ2cgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZGogbW9uZXkgbnVsbCwNCiAgICAgICAgIHhtbGIgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgamx6dCBWQVJDSEFSKDUpIE5VTEwsDQogICAgICAgICBtZW1vIHZhcmNoYXIoMTAyNCkgbnVsbA0KICAgICApDQplbmQgDQplbHNlIA0KYmVnaW4NCiAgICBkcm9wIHRhYmxlIFdOREFUQV9MQ1NGWE1LDQogICAgY3JlYXRlIHRhYmxlIFdOREFUQV9MQ1NGWE1LDQogICAgICgNCiAgICAgICAgIGlkIHZhcmNoYXIoMzIpIG5vdCBudWxsLA0KICAgICAgICAgbmFtZSB2YXJjaGFyKDEyOCkgbm90IG51bGwsDQogICAgICAgICBweSB2YXJjaGFyKDY0KSBudWxsLA0KICAgICAgICAgd2IgdmFyY2hhcig2NCkgbnVsbCwNCiAgICAgICAgIHhtZHcgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZ2cgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHhtZGogbW9uZXkgbnVsbCwNCiAgICAgICAgIHhtbGIgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgamx6dCBWQVJDSEFSKDUpIE5VTEwsDQogICAgICAgICBtZW1vIHZhcmNoYXIoMTAyNCkgbnVsbA0KICAgICApDQplbmQ=','WNDATA_LCSFXMK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData06')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData06','卫宁数据-获取临床收费项目对应信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubGN4bWRtPWIubGN4bWRtLGEueG1kbT1iLnhtZG0sYS5wb3M9Yi5wb3MsYS54bXNsPWIueG1zbCxhLm1lbW89Yi5tZW1vDQpGUk9NIFJJTVNfTENTRlhNRFlLIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfTENTRlhNRFlLIGIobm9sb2NrKSBvbiAgYS5sY3htZG09Yi5sY3htZG0gQU5EIGEueG1kbT1iLnhtZG0NCg0KaW5zZXJ0IGludG8gUklNU19MQ1NGWE1EWUsobGN4bWRtLHhtZG0scG9zLHhtc2wsbWVtbykNCnNlbGVjdCBsY3htZG0seG1kbSxwb3MseG1zbCxtZW1vIGZyb20gV05EQVRBX0xDU0ZYTURZSyBhKG5vbG9jaykNCndoZXJlIG5vdCBleGlzdHMoc2VsZWN0IDEgZnJvbSBSSU1TX0xDU0ZYTURZSyBiKG5vbG9jaykgd2hlcmUgYS5sY3htZG09Yi5sY3htZG0gQU5EIGEueG1kbT1iLnhtZG0pDQoNCmRyb3AgdGFibGUgV05EQVRBX0xDU0ZYTURZSw==','http://172.16.1.56:8889/api/app/his/rims_lcsfxmdyk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0xDU0ZYTURZSycpDQpiZWdpbg0KICAgICBjcmVhdGUgdGFibGUgV05EQVRBX0xDU0ZYTURZSw0KICAgICAoDQogICAgICAgICBsY3htZG0gdmFyY2hhcigzMikgbm90IG51bGwsDQogICAgICAgICB4bWRtIHZhcmNoYXIoMzIpIG5vdCBudWxsLCAgICAgDQogICAgICAgICBwb3MgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgeG1zbCBWQVJDSEFSKDUpIE5VTEwsDQogICAgICAgICBtZW1vIHZhcmNoYXIoMjQpIG51bGwNCiAgICAgKQ0KZW5kIA0KZWxzZSANCmJlZ2luDQogICAgZHJvcCB0YWJsZSBXTkRBVEFfTENTRlhNRFlLDQogICAgY3JlYXRlIHRhYmxlIFdOREFUQV9MQ1NGWE1EWUsNCiAgICAgKA0KICAgICAgICAgbGN4bWRtIHZhcmNoYXIoMzIpIG5vdCBudWxsLA0KICAgICAgICAgeG1kbSB2YXJjaGFyKDMyKSBub3QgbnVsbCwgICAgIA0KICAgICAgICAgcG9zIFZBUkNIQVIoNSkgTlVMTCwNCiAgICAgICAgIHhtc2wgVkFSQ0hBUig1KSBOVUxMLA0KICAgICAgICAgbWVtbyB2YXJjaGFyKDI0KSBudWxsDQogICAgICkNCmVuZA==','WNDATA_LCSFXMDYK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData07')
BEGIN 
    INSERT INTO CronJob( id, name,sysname, system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData07','卫宁数据-获取诊断基础信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIGEgc2V0IGEubmFtZT1iLm5hbWUsYS5weT1MT1dFUihiLnB5KSxhLndiPUxPV0VSKGIud2IpLGEuamx6dD1iLmpsenQsYS5tZW1vPWIubWVtbw0KRlJPTSBSSU1TX1pERE1LIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfWkRETUsgYihub2xvY2spIG9uICBhLmlkPWIuaWQNCg0KaW5zZXJ0IGludG8gUklNU19aRERNSyhpZCxuYW1lLHB5LHdiLGpsenQsbWVtbykNCnNlbGVjdCBpZCxuYW1lLExPV0VSKHB5KSxMT1dFUih3Yiksamx6dCxtZW1vIGZyb20gV05EQVRBX1pERE1LIGEobm9sb2NrKQ0Kd2hlcmUgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIFJJTVNfWkRETUsgYihub2xvY2spIHdoZXJlIGEuaWQ9Yi5pZCkNCg0KZHJvcCB0YWJsZSBXTkRBVEFfWkRETUs=','http://172.16.1.56:8889/api/app/his/rims_zddmk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1pERE1LJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWkRETUsNCiAgICAgKA0KICAgICAgICAgaWQgdmFyY2hhcigzMikgbm90IG51bGwsDQogICAgICAgICBuYW1lIHZhcmNoYXIoMTI4KSBub3QgbnVsbCwgICAgIA0KICAgICAgICAgcHkgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHdiIFZBUkNIQVIoNjQpIE5VTEwsDQogICAgICAgICBqbHp0IFZBUkNIQVIoNSkgTlVMTCwNCiAgICAgICAgIG1lbW8gdmFyY2hhcigyNCkgbnVsbA0KICAgICApDQplbmQgDQplbHNlIA0KYmVnaW4NCiAgICBkcm9wIHRhYmxlIFdOREFUQV9aRERNSw0KICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWkRETUsNCiAgICAgKA0KICAgICAgICAgaWQgdmFyY2hhcigzMikgbm90IG51bGwsDQogICAgICAgICBuYW1lIHZhcmNoYXIoMTI4KSBub3QgbnVsbCwgICAgIA0KICAgICAgICAgcHkgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgIHdiIFZBUkNIQVIoNjQpIE5VTEwsDQogICAgICAgICBqbHp0IFZBUkNIQVIoNSkgTlVMTCwNCiAgICAgICAgIG1lbW8gdmFyY2hhcigyNCkgbnVsbA0KICAgICApDQplbmQ=','WNDATA_ZDDMK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData08')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData08','卫宁数据-获取患者基本信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIFdOREFUQV9CUlhYSyBTRVQgcGF0aWQ9J01aJytwYXRpZCBXSEVSRSB4dGJ6PTANClVQREFURSBXTkRBVEFfQlJYWEsgU0VUIHBhdGlkPSdaWScrcGF0aWQgV0hFUkUgeHRiej0xDQoNClVQREFURSBhIHNldCBhLmJsaD1iLmJsaCxhLmh6eG09Yi5oenhtLGEucHk9TE9XRVIoYi5weSksYS53Yj1MT1dFUihiLndiKSxhLmNhcmRubz1iLmNhcmRubyxhLnNmemg9Yi5zZnpoLGEuc2V4PWIuc2V4LA0KYS5iaXJ0aD1iLmJpcnRoLGEubHhkej1iLmx4ZHosYS5seGRoPWIubHhkaCxhLmx4cj1iLmx4cixhLmxycnE9Q09OVkVSVChWQVJDSEFSLGIuc2RhdGUsMTEyKStDT05WRVJUKFZBUkNIQVIsYi5zZGF0ZSwxMDgpLGEuY3p5aD1iLmxyY3p5aA0KRlJPTSBSSU1TX0JSWFhLIGEobm9sb2NrKQ0KaW5uZXIgam9pbiBXTkRBVEFfQlJYWEsgYihub2xvY2spIG9uICBhLnBhdGlkPWIucGF0aWQgQU5EIGEueHRiej1iLnh0YnogQU5EIElTTlVMTChhLnl5ZG0sJycpPUlTTlVMTChiLnl5ZG0sJycpDQoNCmluc2VydCBpbnRvIFJJTVNfQlJYWEsocGF0aWQsYmxoLGh6eG0scHksd2IsY2FyZG5vLHNmemgsc2V4LGJpcnRoLGx4ZHosbHhkaCxseHIsbHJycSxjenloLHh0YnoseXlkbSkNCnNlbGVjdCBwYXRpZCxibGgsaHp4bSxMT1dFUihweSksTE9XRVIod2IpLGNhcmRubyxzZnpoLHNleCxiaXJ0aCxseGR6LGx4ZGgsbHhyLENPTlZFUlQoVkFSQ0hBUixhLnNkYXRlLDExMikrQ09OVkVSVChWQVJDSEFSLGEuc2RhdGUsMTA4KSxscmN6eWgseHRieixJU05VTEwoeXlkbSwnJykgDQpGUk9NIFdOREFUQV9CUlhYSyBhKG5vbG9jaykNCndoZXJlIG5vdCBleGlzdHMoc2VsZWN0IDEgZnJvbSBSSU1TX0JSWFhLIGIobm9sb2NrKSB3aGVyZSBhLnBhdGlkPWIucGF0aWQgQU5EIGEueHRiej1iLnh0YnogQU5EIElTTlVMTChhLnl5ZG0sJycpPUlTTlVMTChiLnl5ZG0sJycpKQ0KDQpkcm9wIHRhYmxlIFdOREFUQV9CUlhYSw==','http://172.16.1.56:8889/api/app/his/rims_brxxk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0JSWFhLJykNCmJlZ2luDQogICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfQlJYWEsNCiAgICAgKA0KICAgICAgICBwYXRpZCB2YXJjaGFyKDMyKSBOT1QgbnVsbCwNCiAgICAgICAgYmxoIHZhcmNoYXIoMzIpIE5PVCBudWxsLCAgIA0KICAgICAgICBoenhtIFZBUkNIQVIoMTI4KSBOT1QgTlVMTCwgIA0KICAgICAgICBweSBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICB3YiBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICBjYXJkbm8gVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgc2Z6aCBWQVJDSEFSKDIwKSBOVUxMLA0KICAgICAgICBzZXggVkFSQ0hBUig0KSBOVUxMLA0KICAgICAgICBiaXJ0aCBWQVJDSEFSKDE2KSBOVUxMLA0KICAgICAgICBseGR6IFZBUkNIQVIoMTAyNCkgTlVMTCwNCiAgICAgICAgbHhkaCBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICBseHIgVkFSQ0hBUig2NCkgTlVMTCwNCiAgICAgICAgeHRieiBWQVJDSEFSKDUpIE5PVCBOVUxMLA0KICAgICAgICB5eWRtIFZBUkNIQVIoMzIpIE5VTEwsDQogICAgICAgIHNkYXRlIERBVEVUSU1FICBOVUxMLA0KICAgICAgICBscmN6eWggVkFSQ0hBUigzMikgIE5VTEwNCiAgICAgICAgDQogICAgICkNCmVuZCANCmVsc2UgDQpiZWdpbg0KICAgICBkcm9wIHRhYmxlIFdOREFUQV9CUlhYSw0KICAgICBjcmVhdGUgdGFibGUgV05EQVRBX0JSWFhLDQogICAgICgNCiAgICAgICAgcGF0aWQgdmFyY2hhcigzMikgTk9UIG51bGwsDQogICAgICAgIGJsaCB2YXJjaGFyKDMyKSBOT1QgbnVsbCwgICANCiAgICAgICAgaHp4bSBWQVJDSEFSKDEyOCkgTk9UIE5VTEwsICANCiAgICAgICAgcHkgVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgd2IgVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgY2FyZG5vIFZBUkNIQVIoMzIpIE5VTEwsDQogICAgICAgIHNmemggVkFSQ0hBUigyMCkgTlVMTCwNCiAgICAgICAgc2V4IFZBUkNIQVIoNCkgTlVMTCwNCiAgICAgICAgYmlydGggVkFSQ0hBUigxNikgTlVMTCwNCiAgICAgICAgbHhkeiBWQVJDSEFSKDEwMjQpIE5VTEwsDQogICAgICAgIGx4ZGggVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgbHhyIFZBUkNIQVIoNjQpIE5VTEwsDQogICAgICAgIHh0YnogVkFSQ0hBUig1KSBOT1QgTlVMTCwNCiAgICAgICAgeXlkbSBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICBzZGF0ZSBEQVRFVElNRSAgTlVMTCwNCiAgICAgICAgbHJjenloIFZBUkNIQVIoMzIpICBOVUxMDQogICAgICAgIA0KICAgICApDQplbmQ=','WNDATA_BRXXK','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData09')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData09','卫宁数据-获取患者就诊信息','卫宁数据','WnData',
	'',GETDATE(),
	'VVBEQVRFIFdOREFUQV9CUkxJU1QgU0VUIHBhdGlkPSdNWicrcGF0aWQgV0hFUkUgeHRiej0wDQpVUERBVEUgV05EQVRBX0JSTElTVCBTRVQgcGF0aWQ9J1pZJytwYXRpZCBXSEVSRSB4dGJ6PTENCg0KVVBEQVRFIGEgc2V0IGEuYmxoPWIuYmxoLGEuaHp4bT1iLmh6eG0sYS5raD1iLmNhcmRubyxhLnNmemg9Yi5zZnpoLGEueGI9Yi5zZXgsDQphLmNzcnE9Yi5iaXJ0aCxhLmN3ZG09Yi5jd2RtLGEuYnJ6dD1iLmJyenQsYS5qenJxPWIuanpycSxhLnJ5cnE9Yi5yeXJxLGEuY3lycT1iLmN5cnEsYS5rc2RtPWIua3NkbSxhLmtzbWM9Yi5rc21jLA0KYS5icWRtPWIuYnFkbSxhLmJxbWM9Yi5icW1jLGEuY3Jiej1iLmNyYnosYS56enlzZG09Yi56enlzZG0NCkZST00gUklNU19aTEJSTElTVCBhKG5vbG9jaykNCmlubmVyIGpvaW4gV05EQVRBX0JSTElTVCBiKG5vbG9jaykgb24gIGEucGF0aWQ9Yi5wYXRpZCBBTkQgYS54dGJ6PWIueHRieiBBTkQgYS5zeXhoPWIuc3l4aCBBTkQgYS55eWRtPWIueXlkbQ0KDQppbnNlcnQgaW50byBSSU1TX1pMQlJMSVNUKHBhdGlkLGJsaCxoenhtLGtoLHNmemgseGIsY3NycSxzeXhoLGN3ZG0sYnJ6dCxqenJxLHJ5cnEsY3lycSxrc2RtLGtzbWMsYnFkbSxicW1jLGNyYnosenp5c2RtLHh0YnoseXlkbSkNCnNlbGVjdCBwYXRpZCxibGgsaHp4bSxhLmNhcmRubyxzZnpoLHNleCxiaXJ0aCxzeXhoLGN3ZG0sYnJ6dCxqenJxLHJ5cnEsY3lycSxrc2RtLGtzbWMsYnFkbSxicW1jLGNyYnosenp5c2RtLHh0YnoseXlkbSANCkZST00gV05EQVRBX0JSTElTVCBhKG5vbG9jaykNCndoZXJlIGlzbnVsbChhLnBhdGlkLCcnKTw+JycgYW5kIG5vdCBleGlzdHMoc2VsZWN0IDEgZnJvbSBSSU1TX1pMQlJMSVNUIGIobm9sb2NrKSB3aGVyZSAgYS5wYXRpZD1iLnBhdGlkIEFORCBhLnh0Yno9Yi54dGJ6IEFORCBhLnN5eGg9Yi5zeXhoIEFORCBhLnl5ZG09Yi55eWRtKQ0KDQpkcm9wIHRhYmxlIFdOREFUQV9CUkxJU1Q=',
	'http://172.16.1.56:8889/api/app/his/rims_brlist',
	'aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX0JSTElTVCcpDQpiZWdpbg0KICAgICBjcmVhdGUgdGFibGUgV05EQVRBX0JSTElTVA0KICAgICAoDQogICAgICAgICBwYXRpZCB2YXJjaGFyKDMyKSAgbnVsbCwNCiAgICAgICAgIGJsaCB2YXJjaGFyKDMyKSAgbnVsbCwgICANCiAgICAgICAgIGh6eG0gVkFSQ0hBUigxMjgpICBOVUxMLCAgDQogICAgICAgICBweSBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICAgd2IgVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgIGNhcmRubyBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICAgc2Z6aCBWQVJDSEFSKDIwKSBOVUxMLA0KICAgICAgICAgc2V4IFZBUkNIQVIoNCkgTlVMTCwNCiAgICAgICAgIGJpcnRoIFZBUkNIQVIoMTYpIE5VTEwsDQogICAgICAgICBzeXhoIFZBUkNIQVIoMzIpICBOVUxMLA0KICAgICAgICAgY3dkbSBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICAgYnJ6dCBWQVJDSEFSKDUpIE5PVCBOVUxMLA0KICAgICAgICAgeHRieiBWQVJDSEFSKDUpIE5PVCBOVUxMLA0KICAgICAgICAgeXlkbSBWQVJDSEFSKDMyKSBOVUxMLA0KICAgICAgICAganpycSBWQVJDSEFSKDE2KSBOT1QgTlVMTCwNCiAgICAgICAgIHJ5cnEgVkFSQ0hBUigxNikgTlVMTCwNCiAgICAgICAgIGN5cnEgVkFSQ0hBUigxNikgTlVMTCwNCiAgICAgICAgIGtzZG0gVkFSQ0hBUigxNikgTlVMTCwNCiAgICAgICAgIGtzbWMgVkFSQ0hBUigyNTYpIE5VTEwsDQogICAgICAgICBicWRtIFZBUkNIQVIoMTYpIE5VTEwsDQogICAgICAgICBicW1jIFZBUkNIQVIoMjU2KSBOVUxMLA0KICAgICAgICAgY3JieiBWQVJDSEFSKDUpIE5PVCBOVUxMLA0KICAgICAgICAgenp5c2RtIFZBUkNIQVIoMzIpIE5VTEwNCiAgICAgKQ0KZW5kIA0KZWxzZSANCmJlZ2luDQogICAgZHJvcCB0YWJsZSBXTkRBVEFfQlJMSVNUDQogICAgY3JlYXRlIHRhYmxlIFdOREFUQV9CUkxJU1QNCiAgICAgKA0KICAgICAgICAgcGF0aWQgdmFyY2hhcigzMikgIG51bGwsDQogICAgICAgICBibGggdmFyY2hhcigzMikgIG51bGwsICAgDQogICAgICAgICBoenhtIFZBUkNIQVIoMTI4KSAgTlVMTCwgIA0KICAgICAgICAgcHkgVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgIHdiIFZBUkNIQVIoMzIpIE5VTEwsDQogICAgICAgICBjYXJkbm8gVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgIHNmemggVkFSQ0hBUigyMCkgTlVMTCwNCiAgICAgICAgIHNleCBWQVJDSEFSKDQpIE5VTEwsDQogICAgICAgICBiaXJ0aCBWQVJDSEFSKDE2KSBOVUxMLA0KICAgICAgICAgc3l4aCBWQVJDSEFSKDMyKSBOT1QgTlVMTCwNCiAgICAgICAgIGN3ZG0gVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgIGJyenQgVkFSQ0hBUig1KSBOT1QgTlVMTCwNCiAgICAgICAgIHh0YnogVkFSQ0hBUig1KSBOT1QgTlVMTCwNCiAgICAgICAgIHl5ZG0gVkFSQ0hBUigzMikgTlVMTCwNCiAgICAgICAgIGp6cnEgVkFSQ0hBUigxNikgTk9UIE5VTEwsDQogICAgICAgICByeXJxIFZBUkNIQVIoMTYpIE5VTEwsDQogICAgICAgICBjeXJxIFZBUkNIQVIoMTYpIE5VTEwsDQogICAgICAgICBrc2RtIFZBUkNIQVIoMTYpIE5VTEwsDQogICAgICAgICBrc21jIFZBUkNIQVIoMjU2KSBOVUxMLA0KICAgICAgICAgYnFkbSBWQVJDSEFSKDE2KSBOVUxMLA0KICAgICAgICAgYnFtYyBWQVJDSEFSKDI1NikgTlVMTCwNCiAgICAgICAgIGNyYnogVkFSQ0hBUig1KSBOT1QgTlVMTCwNCiAgICAgICAgIHp6eXNkbSBWQVJDSEFSKDMyKSBOVUxMDQogICAgICkNCmVuZA==',
	'WNDATA_BRLIST',
	'0 0/3 * * * ? *',
	1
END 
GO

IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData10')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData10','卫宁数据-获取患者项目信息','卫宁数据','WnData','',GETDATE(),'REVDTEFSRSBAbXpyaW1zYnogVkFSQ0hBUigyKSwgCiAgICAgICAgQHp5cmltc2J6IFZBUkNIQVIoMikKU0VMRUNUIEBtenJpbXNiej0gQ0FTRSBXSEVOIElTTlVMTChDT05GSUcsJ+aYrycpPSflkKYnIFRIRU4gJzMnIEVMU0UgJzAnIEVORCAgRlJPTSBTWVNfQ09ORklHKE5PTE9DSykgV0hFUkUgSUQ9J1IxMjMnClNFTEVDVCBAenlyaW1zYno9IENBU0UgV0hFTiBJU05VTEwoQ09ORklHLCfmmK8nKT0n5ZCmJyBUSEVOICczJyBFTFNFICcwJyBFTkQgIEZST00gU1lTX0NPTkZJRyhOT0xPQ0spIFdIRVJFIElEPSdSMTI0JwpJRiBJU05VTEwoQG16cmltc2J6LCcnKT0nJwpCRUdJTgogICBTRUxFQ1QgQG16cmltc2J6PScwJwpFTkQgCklGIElTTlVMTChAenlyaW1zYnosJycpPScnCkJFR0lOCiAgIFNFTEVDVCBAenlyaW1zYno9JzAnCkVORCAKVVBEQVRFIFdOREFUQV9YTUxJU1QgU0VUIHBhdGlkPSdNWicrcGF0aWQgV0hFUkUgeHRiej0wClVQREFURSBXTkRBVEFfWE1MSVNUIFNFVCBwYXRpZD0nWlknK3BhdGlkIFdIRVJFIHh0Yno9MQoKaW5zZXJ0IGludG8gUklNU19aTERYTUxJU1QocGF0aWQsYmxoLHh0YnoseXlkbSxzeXhoLHFxa3NkbSxxcWtzbWMseXp4aCxxcWx4LHFxeGgscXFteHhoLAp5c2RtLHlzbWMscXFycSxscnJxLGl0ZW1jb2RlLGl0ZW1uYW1lLHByaWNlLGl0ZW1xdHksamxkdyx5cGdnLHNxZHhoLHRzeWZkbSx5cGpsLHRzLHlwcGMscGNtYywKeXp6dCx5emxycnEseXprc3NqLHl6dHpzaixzaHosdHp6LHRicnEscmltc2J6LGxjeG1kbSxsY3htbWMpCnNlbGVjdCBwYXRpZCxibGgseHRieix5eWRtLHN5eGgscXFrc2RtLHFxa3NtYyx5enhoLHFxbHgscXF4aCxxcW14eGgsCnlzZG0seXNtYyxxcXJxLHFxcnEsYS54bWRtLHhtbWMseG1kaix4bXNsLHhtZHcseG1nZyxzcWR4aCx6eGtzZG0sZGN6bGwsdHMscGNkbSxwY21jLAp5enp0LHl6bHJycSx5emtzc2oseXp0enNqLHNoeix0enosQ09OVkVSVChWQVJDSEFSLEdFVERBVEUoKSwxMTIpK0NPTlZFUlQoVkFSQ0hBUixHRVREQVRFKCksMTA4KSwKQ0FTRSBXSEVOIGEueHRiej0wIFRIRU4gQG16cmltc2J6IEVMU0UgQHp5cmltc2J6IEVORCxDQVNFIFdIRU4gYS54bWxiPTAgVEhFTiAnMCcgRUxTRSBhLnhtZG0gRU5ELCAKQ0FTRSBXSEVOIGEueG1sYj0wIFRIRU4gJycgRUxTRSBhLnhtbWMgRU5ECkZST00gV05EQVRBX1hNTElTVCBhKG5vbG9jaykKSU5ORVIgSk9JTiBSSU1TX1hNRkxEWUsgYihub2xvY2spIE9OIGEueG1kbT1iLnhtZG0gQU5EIGEueG1sYj1iLnhtbGIgQU5EIGIuamx6dD0wCklOTkVSIEpPSU4gUklNU19aTEZMSyBjKG5vbG9jaykgT04gYS56eGtzZG09Yy50c2tzIEFORCBiLmZsZG09Yy5pZCAKd2hlcmUgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIFJJTVNfWkxEWE1MSVNUIGQobm9sb2NrKSB3aGVyZSAgYS5xcXhoPWQucXF4aCBBTkQgYS5xcW14eGg9ZC5xcW14eGggQU5EIGEucGF0aWQ9ZC5wYXRpZCBBTkQgYS54dGJ6PWQueHRieiBBTkQgYS5zeXhoPWQuc3l4aCBBTkQgYS55eWRtPWQueXlkbSkKCgpFWEVDIGRiby51c3Bfcmltc193enh4bV9jZm14Cgpkcm9wIHRhYmxlIFdOREFUQV9YTUxJU1Q=','http://172.16.1.56:8889/api/app/his/rims_xmlist','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1hNTElTVCcpCmJlZ2luCiAgICAgY3JlYXRlIHRhYmxlIFdOREFUQV9YTUxJU1QKICAgICAoCiAgICAgICAgIHBhdGlkIHZhcmNoYXIoMzIpIE5PVCBudWxsLAogICAgICAgICBibGggdmFyY2hhcigzMikgIG51bGwsICAgCiAgICAgICAgIHh0YnogVkFSQ0hBUig1KSBOT1QgTlVMTCwgIAogICAgICAgICB5eWRtIFZBUkNIQVIoMzIpIE5VTEwsCiAgICAgICAgIHN5eGggVkFSQ0hBUigzMikgTk9UIE5VTEwsCiAgICAgICAgIHFxa3NkbSBWQVJDSEFSKDMyKSBOT1QgTlVMTCwKICAgICAgICAgcXFrc21jIFZBUkNIQVIoMTI4KSBOT1QgTlVMTCwKCQkgeXp4aCBWQVJDSEFSKDMyKSBOT1QgTlVMTCwKCQkgcXFseCBWQVJDSEFSKDUpIE5PVCBOVUxMLAoJCSBxcXhoIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSBxcW14eGggVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHlzZG0gVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHlzbWMgVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHFxcnEgVkFSQ0hBUig1KSBOT1QgTlVMTCwKCQkgeG1sYiBWQVJDSEFSKDE2KSBOT1QgTlVMTCwKCQkgeG1kbSBWQVJDSEFSKDMyKSBOT1QgTlVMTCwKCQkgeG1tYyBWQVJDSEFSKDEyOCkgTk9UIE5VTEwsCgkJIHhtZGogbW9uZXkgTk9UIE5VTEwsCiAgICAgICAgIHhtc2wgVkFSQ0hBUigxMCkgTk9UIE5VTEwsCgkJIHhtZHcgVkFSQ0hBUig4KSBOVUxMLAogICAgICAgICB4bWdnIFZBUkNIQVIoMzIpIE5VTEwsCgkJIHNxZHhoIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSB6eGtzZG0gVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIGRjemxsIFZBUkNIQVIoMTApIE5PVCBOVUxMLAoJCSB0cyBWQVJDSEFSKDEwKSBOT1QgTlVMTCwKCQkgcGNkbSBWQVJDSEFSKDMyKSBOVUxMLAoJCSBwY21jIFZBUkNIQVIoMzIpIE5VTEwsCgkJIHl6enQgVkFSQ0hBUig1KSBOVUxMLAoJCSB5emxycnEgVkFSQ0hBUigxNikgTlVMTCwKCQkgeXprc3NqIFZBUkNIQVIoMTYpIE5VTEwsCgkJIHl6dHpzaiBWQVJDSEFSKDE2KSBOVUxMLAoJCSBzaHogVkFSQ0hBUigzMikgTlVMTCwKCQkgdHp6IFZBUkNIQVIoMzIpIE5VTEwgCiAgICAgKQplbmQgCmVsc2UgCmJlZ2luCiAgICBkcm9wIHRhYmxlIFdOREFUQV9YTUxJU1QKICAgIGNyZWF0ZSB0YWJsZSBXTkRBVEFfWE1MSVNUCiAgICAgKAogICAgICAgICBwYXRpZCB2YXJjaGFyKDMyKSBOT1QgbnVsbCwKICAgICAgICAgYmxoIHZhcmNoYXIoMzIpICBudWxsLCAgIAogICAgICAgICB4dGJ6IFZBUkNIQVIoNSkgTk9UIE5VTEwsICAKICAgICAgICAgeXlkbSBWQVJDSEFSKDMyKSBOVUxMLAoJCSBzeXhoIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSBxcWtzZG0gVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHFxa3NtYyBWQVJDSEFSKDEyOCkgTk9UIE5VTEwsCgkJIHl6eGggVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHFxbHggVkFSQ0hBUig1KSBOT1QgTlVMTCwKCQkgcXF4aCBWQVJDSEFSKDMyKSBOT1QgTlVMTCwKCQkgcXFteHhoIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSB5c2RtIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSB5c21jIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSBxcXJxIFZBUkNIQVIoNSkgTk9UIE5VTEwsCgkJIHhtbGIgVkFSQ0hBUigxNikgTk9UIE5VTEwsCgkJIHhtZG0gVkFSQ0hBUigzMikgTk9UIE5VTEwsCgkJIHhtbWMgVkFSQ0hBUigxMjgpIE5PVCBOVUxMLAoJCSB4bWRqIG1vbmV5IE5PVCBOVUxMLAogICAgICAgICB4bXNsIFZBUkNIQVIoMTApIE5PVCBOVUxMLAoJCSB4bWR3IFZBUkNIQVIoOCkgTlVMTCwKICAgICAgICAgeG1nZyBWQVJDSEFSKDMyKSBOVUxMLAoJCSBzcWR4aCBWQVJDSEFSKDMyKSBOT1QgTlVMTCwKCQkgenhrc2RtIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAoJCSBkY3psbCBWQVJDSEFSKDEwKSBOT1QgTlVMTCwKCQkgdHMgVkFSQ0hBUigxMCkgTk9UIE5VTEwsCgkJIHBjZG0gVkFSQ0hBUigzMikgTlVMTCwKCQkgcGNtYyBWQVJDSEFSKDMyKSBOVUxMLAoJCSB5enp0IFZBUkNIQVIoNSkgTlVMTCwKCQkgeXpscnJxIFZBUkNIQVIoMTYpIE5VTEwsCgkJIHl6a3NzaiBWQVJDSEFSKDE2KSBOVUxMLAoJCSB5enR6c2ogVkFSQ0hBUigxNikgTlVMTCwKCQkgc2h6IFZBUkNIQVIoMzIpIE5VTEwsCgkJIHR6eiBWQVJDSEFSKDMyKSBOVUxMIAogICAgICkKRU5E','WNDATA_XMLIST','0 0/3 * * * ? *',1
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='WnData' AND id='WnData11')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'WnData11','卫宁数据-获取患者诊断信息','卫宁数据','WnData','',GETDATE(),'VVBEQVRFIFdOREFUQV9aRExJU1QgU0VUIHBhdGlkPSdNWicrcGF0aWQgV0hFUkUgeHRiej0wDQpVUERBVEUgV05EQVRBX1pETElTVCBTRVQgcGF0aWQ9J1pZJytwYXRpZCBXSEVSRSB4dGJ6PTENCg0KSU5TRVJUIElOVE8gUklNU19CUlpEUUsocGF0aWQseHRieixnaHhoLHN5eGgsemRseCx6ZGxiLHpkZG0semRtYyx5c2RtLHlzbWMsbHJycSkNClNFTEVDVCBwYXRpZCx4dGJ6LHN5eGgsMCx6ZGx4LHpkbGIsemRkbSx6ZG1jLHlzZG0seXNtYyxscnJxDQpGUk9NIFdOREFUQV9aRExJU1QgYShub2xvY2spDQpXSEVSRSBhLnh0Yno9MCBBTkQgTk9UIEVYSVNUUyhTRUxFQ1QgMSBGUk9NIFJJTVNfQlJaRFFLIGQobm9sb2NrKSANCldIRVJFIGEucGF0aWQ9ZC5wYXRpZCBBTkQgYS54dGJ6PWQueHRieiBBTkQgYS5zeXhoPWQuZ2h4aCBBTkQgYS55eWRtPWQueXlkbSBBTkQgYS56ZGx4PWQuemRseCBBTkQgYS56ZGxiPWQuemRsYiBBTkQgYS55c2RtPWQueXNkbSBBTkQgYS5scnJxPWQubHJycSkNClVOSU9OIA0KU0VMRUNUIHBhdGlkLHh0YnosMCxzeXhoLHpkbHgsemRsYix6ZGRtLHpkbWMseXNkbSx5c21jLGxycnENCkZST00gV05EQVRBX1pETElTVCBhKG5vbG9jaykNCldIRVJFIGEueHRiej0xIEFORCBOT1QgRVhJU1RTKFNFTEVDVCAxIEZST00gUklNU19CUlpEUUsgZChub2xvY2spIA0KV0hFUkUgYS5wYXRpZD1kLnBhdGlkIEFORCBhLnh0Yno9ZC54dGJ6IEFORCBhLnN5eGg9ZC5zeXhoIEFORCBhLnl5ZG09ZC55eWRtIEFORCBhLnpkbHg9ZC56ZGx4IEFORCBhLnpkbGI9ZC56ZGxiIEFORCBhLnlzZG09ZC55c2RtIEFORCBhLmxycnE9ZC5scnJxKQ0KDQpEUk9QIFRBQkxFIFdOREFUQV9aRExJU1Q=','http://172.16.1.56:8889/api/app/his/rims_brzdqk','aWYgbm90IGV4aXN0cyhzZWxlY3QgMSBmcm9tIHN5c29iamVjdHMgd2hlcmUgbmFtZT0nV05EQVRBX1pETElTVCcpDQpiZWdpbg0KICAgICBjcmVhdGUgdGFibGUgV05EQVRBX1pETElTVA0KICAgICAoDQogICAgICAgICBwYXRpZCB2YXJjaGFyKDMyKSBOT1QgTlVMTCwNCiAgICAgICAgIHh0YnogdmFyY2hhcig1KSAgTk9UIE5VTEwsICAgDQoJCSB5eWRtIFZBUkNIQVIoMzIpIE5PVCBOVUxMLCAgDQoJCSBzeXhoIFZBUkNIQVIoMzIpIE5PVCBOVUxMLAkJDQoJCSB5c2RtIFZBUkNIQVIoMzIpIE5PVCBOVUxMLA0KCQkgeXNtYyBWQVJDSEFSKDEyOCkgTk9UIE5VTEwsDQoJCSB6ZGx4IFZBUkNIQVIoNSkgTk9UIE5VTEwsDQoJCSB6ZGxiIFZBUkNIQVIoNSkgTk9UIE5VTEwsDQoJCSB6ZGRtIFZBUkNIQVIoMzIpIE5PVCBOVUxMLA0KCQkgemRtYyBWQVJDSEFSKDY0KSBOT1QgTlVMTCwNCgkJIGxycnEgVkFSQ0hBUigxNikgTk9UIE5VTEwNCiAgICAgKQ0KZW5kIA0KZWxzZSANCmJlZ2luDQogICAgdHJ1bmNhdGUgdGFibGUgV05EQVRBX1pETElTVA0KRU5E','WNDATA_ZDLIST','0 0/3 * * * ? *',1
END 
GO

--IF NOT EXISTS(SELECT 1 FROM RIMS_COM_SQL WHERE system='WnData' AND id='WnData12')
--BEGIN 
--    INSERT INTO dbo.RIMS_COM_SQL( id, name, system, memo, oper_date,sql,weburl,createtmp,tmpname,expression)
--    SELECT 'WnData12','卫宁数据-获取患者病历信息','WnData','',GETDATE(),'','http://172.16.1.56:8889/api/app/his/rims_emr','','','0 0/3 * * * ? *'
--END 
--GO

IF NOT EXISTS(SELECT * FROM CronJob WHERE system='RIMS' AND id='Rims00')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'Rims00','康复业务-定时清理作业记录','康复业务','RIMS','',GETDATE(),'','','','','0 0/5 * * * ? *',0
END 
GO
IF NOT EXISTS(SELECT * FROM CronJob WHERE system='Admin' AND id='Admin00')
BEGIN 
    INSERT INTO CronJob( id, name, sysname,system, memo, oper_date,sql,weburl,createtmp,tmpname,expression,jlzt)
    SELECT 'Admin00','系统业务-保存业务数据','系统业务','Admin','',GETDATE(),'','','','','',0
END 
GO

--DELETE RIMS_COM_SQL WHERE id='Rims00'

IF EXISTS(SELECT 1 FROM sysobjects WHERE name='usp_jk_clearjobhistory')
   DROP PROC usp_jk_clearjobhistory
GO
CREATE PROC usp_jk_clearjobhistory
   
AS
DECLARE @now VARCHAR(16)

SELECT @now=CONVERT(VARCHAR,GETDATE()-1,112)

DELETE CronJob_JOBHISTORY WHERE oper_date<=@now

IF	@@ERROR<>0
BEGIN
   SELECT 'F','清理发生异常'
   return
END 
SELECT 'T','清理完成'
RETURN
GO


IF EXISTS(SELECT 1 FROM sysobjects WHERE name='usp_jk_getjobzxtj')
   DROP PROC usp_jk_getjobzxtj
GO
CREATE PROC usp_jk_getjobzxtj
 @id VARCHAR(32)='',
 @system VARCHAR(32)=''
AS
  DECLARE @kssj VARCHAR(32),@jssj VARCHAR(32)
  SELECT @kssj=CONVERT(VARCHAR(32),GETDATE(),23),@jssj=CONVERT(VARCHAR(32),GETDATE()+1,23)

  SELECT  '{"startTime": "'+@kssj+'","endTime": "'+@jssj+'"}'
RETURN
GO


--exec usp_rims_jk_getjobhistory @id='WnData00',@sys='WnData'


IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_SFXXMK') AND name='id' )
BEGIN 
   
   DECLARE @pkname VARCHAR(1024)
   SELECT @pkname=CONSTRAINT_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
   WHERE TABLE_NAME='RIMS_SFXXMK'
   EXEC('ALTER TABLE RIMS_SFXXMK DROP CONSTRAINT '+@pkname)
   ALTER TABLE RIMS_SFXXMK ALTER COLUMN id VARCHAR(32) NOT NULL 
   ALTER TABLE RIMS_SFXXMK ADD CONSTRAINT PK_RIMS_SFXXMK PRIMARY KEY(id)  
END 
GO


IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_SFXXMK') AND name='name' )
BEGIN 
   ALTER TABLE RIMS_SFXXMK ALTER COLUMN name VARCHAR(128) NOT NULL 
END 
GO

IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMK') AND name='id' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMK ALTER COLUMN id VARCHAR(32) NOT NULL 
END 
GO
IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMK') AND name='name' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMK ALTER COLUMN name VARCHAR(128) NOT NULL 
END 
GO
IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMK') AND name='xmdw' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMK ALTER COLUMN xmdw VARCHAR(128) NULL 
END 
GO
IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMK') AND name='memo' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMK ALTER COLUMN memo VARCHAR(1024) NULL 
END 
GO
IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMDYK') AND name='lcxmdm' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMDYK ALTER COLUMN lcxmdm VARCHAR(32) NOT NULL 
END 
GO
IF EXISTS(SELECT 1 FROM syscolumns WHERE id=OBJECT_ID('RIMS_LCSFXMDYK') AND name='xmdm' )
BEGIN 
   ALTER TABLE RIMS_LCSFXMDYK ALTER COLUMN xmdm VARCHAR(32) NOT NULL 
END 
GO





